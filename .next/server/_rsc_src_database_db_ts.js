"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "_rsc_src_database_db_ts";
exports.ids = ["_rsc_src_database_db_ts"];
exports.modules = {

/***/ "(rsc)/./src/database/db.ts":
/*!****************************!*\
  !*** ./src/database/db.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   allQuery: () => (/* binding */ allQuery),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   getQuery: () => (/* binding */ getQuery),\n/* harmony export */   initializeDatabase: () => (/* binding */ initializeDatabase),\n/* harmony export */   runQuery: () => (/* binding */ runQuery)\n/* harmony export */ });\n/* harmony import */ var sqlite3__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! sqlite3 */ \"sqlite3\");\n/* harmony import */ var sqlite3__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(sqlite3__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_1__);\n\n\nconst DB_PATH = path__WEBPACK_IMPORTED_MODULE_1___default().join(process.cwd(), \"database.sqlite\");\nconst db = new (sqlite3__WEBPACK_IMPORTED_MODULE_0___default().Database)(DB_PATH, (err)=>{\n    if (err) {\n        console.error(\"Erro ao conectar com SQLite:\", err.message);\n    } else {\n        console.log(\"Conectado ao SQLite\");\n    }\n});\nfunction runQuery(sql, params = []) {\n    return new Promise((resolve, reject)=>{\n        db.run(sql, params, function(err) {\n            if (err) {\n                reject(err);\n            } else {\n                resolve({\n                    id: this.lastID,\n                    changes: this.changes\n                });\n            }\n        });\n    });\n}\nfunction getQuery(sql, params = []) {\n    return new Promise((resolve, reject)=>{\n        db.get(sql, params, (err, row)=>{\n            if (err) {\n                reject(err);\n            } else {\n                resolve(row);\n            }\n        });\n    });\n}\nfunction allQuery(sql, params = []) {\n    return new Promise((resolve, reject)=>{\n        db.all(sql, params, (err, rows)=>{\n            if (err) {\n                reject(err);\n            } else {\n                resolve(rows);\n            }\n        });\n    });\n}\nasync function initializeDatabase() {\n    try {\n        await runQuery(`\n      CREATE TABLE IF NOT EXISTS patients (\n        id INTEGER PRIMARY KEY AUTOINCREMENT,\n        name TEXT NOT NULL,\n        dateOfBirth DATE,\n        phone TEXT,\n        createdAt DATETIME DEFAULT CURRENT_TIMESTAMP,\n        updatedAt DATETIME DEFAULT CURRENT_TIMESTAMP\n      )\n    `);\n        await runQuery(`\n      CREATE TABLE IF NOT EXISTS attachments (\n        id INTEGER PRIMARY KEY AUTOINCREMENT,\n        filename TEXT NOT NULL,\n        originalName TEXT NOT NULL,\n        mimeType TEXT NOT NULL,\n        size INTEGER NOT NULL,\n        path TEXT NOT NULL,\n        patientId INTEGER NOT NULL,\n        createdAt DATETIME DEFAULT CURRENT_TIMESTAMP,\n        FOREIGN KEY (patientId) REFERENCES patients(id) ON DELETE CASCADE\n      )\n    `);\n        await runQuery(`CREATE INDEX IF NOT EXISTS idx_attachments_patient_id ON attachments(patientId)`);\n        await runQuery(`CREATE INDEX IF NOT EXISTS idx_patients_name ON patients(name)`);\n        console.log(\"Database initialized successfully!\");\n    } catch (error) {\n        console.error(\"Error initializing database:\", error);\n        throw error;\n    }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (db);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvZGF0YWJhc2UvZGIudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBQTZCO0FBQ047QUFFdkIsTUFBTUUsVUFBVUQsZ0RBQVMsQ0FBQ0csUUFBUUMsR0FBRyxJQUFJO0FBRXpDLE1BQU1DLEtBQUssSUFBSU4seURBQWdCLENBQUNFLFNBQVMsQ0FBQ007SUFDeEMsSUFBSUEsS0FBSztRQUNQQyxRQUFRQyxLQUFLLENBQUMsZ0NBQWdDRixJQUFJRyxPQUFPO0lBQzNELE9BQU87UUFDTEYsUUFBUUcsR0FBRyxDQUFDO0lBQ2Q7QUFDRjtBQUVPLFNBQVNDLFNBQVNDLEdBQVcsRUFBRUMsU0FBZ0IsRUFBRTtJQUN0RCxPQUFPLElBQUlDLFFBQVEsQ0FBQ0MsU0FBU0M7UUFDM0JaLEdBQUdhLEdBQUcsQ0FBQ0wsS0FBS0MsUUFBUSxTQUFTUCxHQUFHO1lBQzlCLElBQUlBLEtBQUs7Z0JBQ1BVLE9BQU9WO1lBQ1QsT0FBTztnQkFDTFMsUUFBUTtvQkFBRUcsSUFBSSxJQUFJLENBQUNDLE1BQU07b0JBQUVDLFNBQVMsSUFBSSxDQUFDQSxPQUFPO2dCQUFDO1lBQ25EO1FBQ0Y7SUFDRjtBQUNGO0FBRU8sU0FBU0MsU0FBU1QsR0FBVyxFQUFFQyxTQUFnQixFQUFFO0lBQ3RELE9BQU8sSUFBSUMsUUFBUSxDQUFDQyxTQUFTQztRQUMzQlosR0FBR2tCLEdBQUcsQ0FBQ1YsS0FBS0MsUUFBUSxDQUFDUCxLQUFLaUI7WUFDeEIsSUFBSWpCLEtBQUs7Z0JBQ1BVLE9BQU9WO1lBQ1QsT0FBTztnQkFDTFMsUUFBUVE7WUFDVjtRQUNGO0lBQ0Y7QUFDRjtBQUVPLFNBQVNDLFNBQVNaLEdBQVcsRUFBRUMsU0FBZ0IsRUFBRTtJQUN0RCxPQUFPLElBQUlDLFFBQVEsQ0FBQ0MsU0FBU0M7UUFDM0JaLEdBQUdxQixHQUFHLENBQUNiLEtBQUtDLFFBQVEsQ0FBQ1AsS0FBS29CO1lBQ3hCLElBQUlwQixLQUFLO2dCQUNQVSxPQUFPVjtZQUNULE9BQU87Z0JBQ0xTLFFBQVFXO1lBQ1Y7UUFDRjtJQUNGO0FBQ0Y7QUFFTyxlQUFlQztJQUNwQixJQUFJO1FBQ0YsTUFBTWhCLFNBQVMsQ0FBQzs7Ozs7Ozs7O0lBU2hCLENBQUM7UUFFRCxNQUFNQSxTQUFTLENBQUM7Ozs7Ozs7Ozs7OztJQVloQixDQUFDO1FBRUQsTUFBTUEsU0FBUyxDQUFDLCtFQUErRSxDQUFDO1FBQ2hHLE1BQU1BLFNBQVMsQ0FBQyw4REFBOEQsQ0FBQztRQUUvRUosUUFBUUcsR0FBRyxDQUFDO0lBQ2QsRUFBRSxPQUFPRixPQUFPO1FBQ2RELFFBQVFDLEtBQUssQ0FBQyxnQ0FBZ0NBO1FBQzlDLE1BQU1BO0lBQ1I7QUFDRjtBQUVBLGlFQUFlSixFQUFFQSxFQUFBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZGVzYWZpby1wZXJzb25hbGl6YS8uL3NyYy9kYXRhYmFzZS9kYi50cz81Mzc0Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBzcWxpdGUzIGZyb20gJ3NxbGl0ZTMnXG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJ1xuXG5jb25zdCBEQl9QQVRIID0gcGF0aC5qb2luKHByb2Nlc3MuY3dkKCksICdkYXRhYmFzZS5zcWxpdGUnKVxuXG5jb25zdCBkYiA9IG5ldyBzcWxpdGUzLkRhdGFiYXNlKERCX1BBVEgsIChlcnIpID0+IHtcbiAgaWYgKGVycikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm8gYW8gY29uZWN0YXIgY29tIFNRTGl0ZTonLCBlcnIubWVzc2FnZSlcbiAgfSBlbHNlIHtcbiAgICBjb25zb2xlLmxvZygnQ29uZWN0YWRvIGFvIFNRTGl0ZScpXG4gIH1cbn0pXG5cbmV4cG9ydCBmdW5jdGlvbiBydW5RdWVyeShzcWw6IHN0cmluZywgcGFyYW1zOiBhbnlbXSA9IFtdKTogUHJvbWlzZTxhbnk+IHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBkYi5ydW4oc3FsLCBwYXJhbXMsIGZ1bmN0aW9uKGVycikge1xuICAgICAgaWYgKGVycikge1xuICAgICAgICByZWplY3QoZXJyKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVzb2x2ZSh7IGlkOiB0aGlzLmxhc3RJRCwgY2hhbmdlczogdGhpcy5jaGFuZ2VzIH0pXG4gICAgICB9XG4gICAgfSlcbiAgfSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFF1ZXJ5KHNxbDogc3RyaW5nLCBwYXJhbXM6IGFueVtdID0gW10pOiBQcm9taXNlPGFueT4ge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgIGRiLmdldChzcWwsIHBhcmFtcywgKGVyciwgcm93KSA9PiB7XG4gICAgICBpZiAoZXJyKSB7XG4gICAgICAgIHJlamVjdChlcnIpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXNvbHZlKHJvdylcbiAgICAgIH1cbiAgICB9KVxuICB9KVxufVxuXG5leHBvcnQgZnVuY3Rpb24gYWxsUXVlcnkoc3FsOiBzdHJpbmcsIHBhcmFtczogYW55W10gPSBbXSk6IFByb21pc2U8YW55W10+IHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBkYi5hbGwoc3FsLCBwYXJhbXMsIChlcnIsIHJvd3MpID0+IHtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgcmVqZWN0KGVycilcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc29sdmUocm93cylcbiAgICAgIH1cbiAgICB9KVxuICB9KVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaW5pdGlhbGl6ZURhdGFiYXNlKCkge1xuICB0cnkge1xuICAgIGF3YWl0IHJ1blF1ZXJ5KGBcbiAgICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIHBhdGllbnRzIChcbiAgICAgICAgaWQgSU5URUdFUiBQUklNQVJZIEtFWSBBVVRPSU5DUkVNRU5ULFxuICAgICAgICBuYW1lIFRFWFQgTk9UIE5VTEwsXG4gICAgICAgIGRhdGVPZkJpcnRoIERBVEUsXG4gICAgICAgIHBob25lIFRFWFQsXG4gICAgICAgIGNyZWF0ZWRBdCBEQVRFVElNRSBERUZBVUxUIENVUlJFTlRfVElNRVNUQU1QLFxuICAgICAgICB1cGRhdGVkQXQgREFURVRJTUUgREVGQVVMVCBDVVJSRU5UX1RJTUVTVEFNUFxuICAgICAgKVxuICAgIGApXG5cbiAgICBhd2FpdCBydW5RdWVyeShgXG4gICAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBhdHRhY2htZW50cyAoXG4gICAgICAgIGlkIElOVEVHRVIgUFJJTUFSWSBLRVkgQVVUT0lOQ1JFTUVOVCxcbiAgICAgICAgZmlsZW5hbWUgVEVYVCBOT1QgTlVMTCxcbiAgICAgICAgb3JpZ2luYWxOYW1lIFRFWFQgTk9UIE5VTEwsXG4gICAgICAgIG1pbWVUeXBlIFRFWFQgTk9UIE5VTEwsXG4gICAgICAgIHNpemUgSU5URUdFUiBOT1QgTlVMTCxcbiAgICAgICAgcGF0aCBURVhUIE5PVCBOVUxMLFxuICAgICAgICBwYXRpZW50SWQgSU5URUdFUiBOT1QgTlVMTCxcbiAgICAgICAgY3JlYXRlZEF0IERBVEVUSU1FIERFRkFVTFQgQ1VSUkVOVF9USU1FU1RBTVAsXG4gICAgICAgIEZPUkVJR04gS0VZIChwYXRpZW50SWQpIFJFRkVSRU5DRVMgcGF0aWVudHMoaWQpIE9OIERFTEVURSBDQVNDQURFXG4gICAgICApXG4gICAgYClcblxuICAgIGF3YWl0IHJ1blF1ZXJ5KGBDUkVBVEUgSU5ERVggSUYgTk9UIEVYSVNUUyBpZHhfYXR0YWNobWVudHNfcGF0aWVudF9pZCBPTiBhdHRhY2htZW50cyhwYXRpZW50SWQpYClcbiAgICBhd2FpdCBydW5RdWVyeShgQ1JFQVRFIElOREVYIElGIE5PVCBFWElTVFMgaWR4X3BhdGllbnRzX25hbWUgT04gcGF0aWVudHMobmFtZSlgKVxuXG4gICAgY29uc29sZS5sb2coJ0RhdGFiYXNlIGluaXRpYWxpemVkIHN1Y2Nlc3NmdWxseSEnKVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluaXRpYWxpemluZyBkYXRhYmFzZTonLCBlcnJvcilcbiAgICB0aHJvdyBlcnJvclxuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IGRiXG5cbiJdLCJuYW1lcyI6WyJzcWxpdGUzIiwicGF0aCIsIkRCX1BBVEgiLCJqb2luIiwicHJvY2VzcyIsImN3ZCIsImRiIiwiRGF0YWJhc2UiLCJlcnIiLCJjb25zb2xlIiwiZXJyb3IiLCJtZXNzYWdlIiwibG9nIiwicnVuUXVlcnkiLCJzcWwiLCJwYXJhbXMiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsInJ1biIsImlkIiwibGFzdElEIiwiY2hhbmdlcyIsImdldFF1ZXJ5IiwiZ2V0Iiwicm93IiwiYWxsUXVlcnkiLCJhbGwiLCJyb3dzIiwiaW5pdGlhbGl6ZURhdGFiYXNlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/database/db.ts\n");

/***/ })

};
;